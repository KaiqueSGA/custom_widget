{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/custom_widgets/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/custom_widgets/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/custom_widgets/project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./device_variables.css';import React,{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var _require=require('../../classes/device/device.js'),tago_device=_require.tago_device;var _require2=require('../../classes/location/location.js'),location_apis=_require2.location_apis;function Device_variables(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),account_devices=_useState2[0],set_account_devices=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),device_variables=_useState4[0],set_device_variables=_useState4[1];var device_methods=new tago_device();var location_funcs=new location_apis();window.TagoIO.onStart(function(widget){window.widget=widget;console.log(\"TRIGGEREDDDDD\");});window.TagoIO.ready();useEffect(function(){device_methods.list().then(function(resp){return set_account_devices(resp);}).catch(function(err){return console.log(err);});},[]);console.log(window.location.protocol+\"//\"+window.location.host+\"/\"+window.location.pathname);console.log(window.TagoIO);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"div-mother\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"div-filho\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-div-mother\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"HELLO MY FRIEND!\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Choose the device that you wish see the variables:\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input\",children:[/*#__PURE__*/_jsx(\"select\",{id:\"devices\",className:\"devices\",children:account_devices.map(function(item){try{return/*#__PURE__*/_jsxs(\"option\",{value:\"\".concat(item.id,\",\").concat(item.name),children:[\" \",item.name,\" \"]});}catch(err){console.log(err);}})}),/*#__PURE__*/_jsx(\"button\",{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var request;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return device_methods.get_device_variables();case 2:request=_context.sent;set_device_variables(request.filter(function(obj){return obj.variable===\"esn\";}));case 4:case\"end\":return _context.stop();}}},_callee);})),children:\" Show variables\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"data_variables\",children:/*#__PURE__*/_jsxs(\"table\",{border:\"1\",className:\"variable_tables\",children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Origin\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Coordinates\"})]}),device_variables.map(function(data){setTimeout(function(){// This delay is necessary because firt i need to create an element with the corresponding tag and after i catch the element through of id \nvar element_id=data.id;var scope=data;document.getElementById(data.id).addEventListener('change',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var element_to_insert_the_new_value,element_to_insert_the_address,mac_coordinates,address,_element_to_insert_the_new_value,_element_to_insert_the_address,lbs_coordinates,_address,element_to_insert_the_coordinates,_element_to_insert_the_address2,gps_coordinates,_address2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(this.value===\"MAC\")){_context2.next=13;break;}element_to_insert_the_new_value=document.getElementsByClassName(element_id)[0];element_to_insert_the_address=document.getElementsByClassName(element_id)[1];_context2.next=5;return location_funcs.get_coordinates_through_mac_datas([\"mac0\",\"mac1\",\"mac2\"],scope);case 5:mac_coordinates=_context2.sent;_context2.next=8;return location_funcs.get_address_through_coordinates(mac_coordinates.lat,mac_coordinates.lng);case 8:address=_context2.sent;element_to_insert_the_new_value.innerText=\"\".concat(mac_coordinates.lat,\",\").concat(mac_coordinates.lng);element_to_insert_the_address.innerText=address;_context2.next=34;break;case 13:if(!(this.value===\"LBS\")){_context2.next=26;break;}_element_to_insert_the_new_value=document.getElementsByClassName(element_id)[0];_element_to_insert_the_address=document.getElementsByClassName(element_id)[1];//Position 1 because i yhave 2 elements with the same tags, the second element will render the address\n_context2.next=18;return location_funcs.get_coordinates_through_lbs_datas([\"lbs0\",\"lbs1\",\"lbs2\"],scope,scope.metadata.lbs_mode===\"LTE\"?\"lte\":\"gsm\");case 18:lbs_coordinates=_context2.sent;_context2.next=21;return location_funcs.get_address_through_coordinates(lbs_coordinates.lat,lbs_coordinates.lng);case 21:_address=_context2.sent;_element_to_insert_the_new_value.innerText=\"\".concat(lbs_coordinates.lat,\",\").concat(lbs_coordinates.lng);_element_to_insert_the_address.innerText=_address;_context2.next=34;break;case 26:element_to_insert_the_coordinates=document.getElementsByClassName(element_id)[0];_element_to_insert_the_address2=document.getElementsByClassName(element_id)[1];gps_coordinates={lat:scope.metadata.lat,lng:scope.metadata.lon};_context2.next=31;return location_funcs.get_address_through_coordinates(gps_coordinates.lat,gps_coordinates.lng);case 31:_address2=_context2.sent;element_to_insert_the_coordinates.innerText=\"\".concat(gps_coordinates.lat,\",\").concat(gps_coordinates.lng);_element_to_insert_the_address2.innerText=_address2;case 34:case\"end\":return _context2.stop();}}},_callee2,this);})));},10);return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"data_variable\",children:data.metadata.origin}),/*#__PURE__*/_jsx(\"td\",{className:\"b\",children:/*#__PURE__*/_jsxs(\"select\",{id:data.id,className:\"coordinate-types\",children:[/*#__PURE__*/_jsx(\"option\",{children:\"Select the data type that you want to see...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"LBS\",children:\"LBS coordinates\"}),/*#__PURE__*/_jsx(\"option\",{value:\"MAC\",children:\"MAC coordinates\"}),/*#__PURE__*/_jsx(\"option\",{value:\"GPS\",children:\"GPS coordinates\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:data.id}),/*#__PURE__*/_jsx(\"td\",{className:data.id})]});})]})})]})})});}export{Device_variables};","map":{"version":3,"names":["React","useEffect","useState","require","tago_device","location_apis","Device_variables","account_devices","set_account_devices","device_variables","set_device_variables","device_methods","location_funcs","window","TagoIO","onStart","widget","console","log","ready","list","then","resp","catch","err","location","protocol","host","pathname","map","item","id","name","get_device_variables","request","filter","obj","variable","data","setTimeout","element_id","scope","document","getElementById","addEventListener","value","element_to_insert_the_new_value","getElementsByClassName","element_to_insert_the_address","get_coordinates_through_mac_datas","mac_coordinates","get_address_through_coordinates","lat","lng","address","innerText","get_coordinates_through_lbs_datas","metadata","lbs_mode","lbs_coordinates","element_to_insert_the_coordinates","gps_coordinates","lon","origin"],"sources":["C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/custom_widgets/project/src/widgets/device_variables/device_variables.js"],"sourcesContent":["import './device_variables.css';\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nconst { tago_device } = require('../../classes/device/device.js');\r\nconst { location_apis } = require('../../classes/location/location.js')\r\n\r\n\r\nfunction Device_variables(){\r\n  const [account_devices, set_account_devices] = useState([]);\r\n  const [device_variables, set_device_variables] = useState([]);\r\n\r\n  const device_methods = new tago_device();\r\n  const location_funcs = new location_apis();\r\n\r\n\r\n     window.TagoIO.onStart((widget) => {\r\n        window.widget = widget;console.log(\"TRIGGEREDDDDD\")\r\n    })\r\n    window.TagoIO.ready(); \r\n\r\n\r\n\r\n\r\n\r\n    useEffect( () => {\r\n        device_methods.list()\r\n           .then((resp) => set_account_devices(resp))\r\n           .catch((err) => console.log(err))\r\n    },[])\r\n\r\n    \r\n    \r\n\r\n   console.log(window.location.protocol + \"//\" + window.location.host + \"/\" + window.location.pathname);\r\n   console.log(window.TagoIO)\r\n\r\n    return(\r\n        <>\r\n\r\n        <div className='div-mother'>\r\n        <div className='div-filho'>\r\n\r\n        <div className='text-div-mother'>\r\n         <h1>HELLO MY FRIEND!</h1>\r\n         <br/>\r\n         <h3>Choose the device that you wish see the variables:</h3>\r\n         </div>\r\n         <div className=\"input\">\r\n                    <select id=\"devices\" className =\"devices\">\r\n                        {account_devices.map((item) =>{\r\n                          try{\r\n                             return(\r\n                                 <option value={`${item.id},${item.name}`}> {item.name} </option>\r\n                             )\r\n                            }catch(err){\r\n                              console.log(err)\r\n                            }\r\n                                      \r\n                        })}\r\n                    </select>\r\n\r\n                    <button onClick={async() =>  { let request = await device_methods.get_device_variables(); set_device_variables(request.filter(obj => obj.variable === \"esn\")); }}> Show variables</button>\r\n                </div> \r\n\r\n\r\n\r\n                <div className='data_variables'>\r\n\r\n                    \r\n                            \r\n\r\n                        <table border=\"1\" className='variable_tables'>\r\n                            <tr>\r\n                                <td>Origin</td>\r\n                                <td>Coordinates</td>\r\n                                  \r\n                            </tr>\r\n                            {device_variables.map(data => {\r\n\r\n                                setTimeout(() => {// This delay is necessary because firt i need to create an element with the corresponding tag and after i catch the element through of id \r\n                                    const element_id = data.id;\r\n                                    const scope = data; \r\n\r\n                                    document.getElementById(data.id).addEventListener('change', async function(){\r\n                                      \r\n                                        if(this.value === \"MAC\"){ \r\n                                          let element_to_insert_the_new_value = document.getElementsByClassName(element_id)[0];\r\n                                          let element_to_insert_the_address = document.getElementsByClassName(element_id)[1]; \r\n\r\n                                          let mac_coordinates = await location_funcs.get_coordinates_through_mac_datas([\"mac0\", \"mac1\", \"mac2\"],scope); \r\n                                          let address = await location_funcs.get_address_through_coordinates(mac_coordinates.lat, mac_coordinates.lng);\r\n                                         \r\n                                          element_to_insert_the_new_value.innerText = `${mac_coordinates.lat},${mac_coordinates.lng}`;\r\n                                          element_to_insert_the_address.innerText = address;\r\n                                        }\r\n                                        else if(this.value === \"LBS\"){\r\n                                          let element_to_insert_the_new_value = document.getElementsByClassName(element_id)[0];\r\n                                          let element_to_insert_the_address = document.getElementsByClassName(element_id)[1];//Position 1 because i yhave 2 elements with the same tags, the second element will render the address\r\n\r\n                                          let lbs_coordinates = await location_funcs.get_coordinates_through_lbs_datas([\"lbs0\", \"lbs1\", \"lbs2\"],scope, scope.metadata.lbs_mode === \"LTE\" ?\"lte\" :\"gsm\" ); \r\n                                          let address = await location_funcs.get_address_through_coordinates(lbs_coordinates.lat, lbs_coordinates.lng);\r\n                                         \r\n                                          element_to_insert_the_new_value.innerText = `${lbs_coordinates.lat},${lbs_coordinates.lng}`; \r\n                                          element_to_insert_the_address.innerText = address;\r\n                                        }\r\n                                        else{ \r\n                                          let element_to_insert_the_coordinates = document.getElementsByClassName(element_id)[0];\r\n                                          let element_to_insert_the_address = document.getElementsByClassName(element_id)[1]; \r\n\r\n                                          let gps_coordinates = { lat:scope.metadata.lat, lng:scope.metadata.lon };\r\n                                          let address = await location_funcs.get_address_through_coordinates(gps_coordinates.lat, gps_coordinates.lng);\r\n                                          \r\n                                          element_to_insert_the_coordinates.innerText = `${gps_coordinates.lat},${gps_coordinates.lng}`;\r\n                                          element_to_insert_the_address.innerText = address;\r\n                                        \r\n                                        }\r\n\r\n                                    })\r\n\r\n                                },10);\r\n                            \r\n                              return( \r\n                                <tr>\r\n                                    <td className='data_variable'>{data.metadata.origin}</td>\r\n\r\n                                    <td className='b'>\r\n                                        <select id={data.id} className =\"coordinate-types\">\r\n                                            <option>Select the data type that you want to see...</option>\r\n                                            <option value=\"LBS\" >LBS coordinates</option>\r\n                                            <option value=\"MAC\" >MAC coordinates</option>\r\n                                            <option value=\"GPS\" >GPS coordinates</option>\r\n                                        </select>\r\n\r\n                                     \r\n                                     </td>\r\n\r\n                                     <td className={data.id}></td>\r\n                                     <td className={data.id}></td>\r\n\r\n                                </tr>\r\n                              )\r\n\r\n                               \r\n  \r\n\r\n\r\n                            })}\r\n\r\n                        </table>\r\n                        \r\n                            \r\n                    \r\n                </div>\r\n\r\n\r\n\r\n\r\n                </div> \r\n\r\n\r\n           \r\n\r\n            </div>         \r\n         \r\n        </>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport { Device_variables };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
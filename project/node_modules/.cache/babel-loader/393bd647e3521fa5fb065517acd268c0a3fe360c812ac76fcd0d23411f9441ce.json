{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst qs_1 = __importDefault(require(\"qs\"));\nconst apiRequest_1 = __importDefault(require(\"../infrastructure/apiRequest\"));\nconst regions_1 = __importDefault(require(\"../regions\"));\n/**\n * Create a Object for Axios\n * @internal\n * @param uri URI\n * @param requestObj doRequestParams\n */\nfunction mountAxiosRequest(uri, requestObj) {\n  const axiosObj = {\n    url: `${uri}${requestObj.path}`,\n    method: requestObj.method,\n    data: requestObj.body,\n    params: requestObj.params,\n    maxContentLength: requestObj.maxContentLength,\n    paramsSerializer: p => qs_1.default.stringify(p),\n    headers: {\n      ...requestObj.headers\n    },\n    ...requestObj.overwriteAxiosConfig\n  };\n  return axiosObj;\n}\n/**\n * Abstract class to wrap all TagoIO SDK Modules\n * @internal\n */\nclass TagoIOModule {\n  constructor(params) {\n    this.params = {};\n    this.params = params;\n    this.validateParams();\n  }\n  validateParams() {\n    if (!this.params) {\n      throw new Error(\"Invalid Params\");\n    }\n    if (!this.params.token) {\n      throw new Error(\"Invalid Token\");\n    }\n    // if (this.params.options && typeof this.params.options !== \"object\") {\n    //   throw new Error(\"Invalid Params\");\n    // }\n  }\n\n  async doRequest(requestObj) {\n    const apiURI = (0, regions_1.default)(this.params.region)?.api;\n    if (!apiURI) {\n      throw new Error(\"Invalid region\");\n    }\n    const axiosObj = mountAxiosRequest(apiURI, requestObj);\n    axiosObj.headers = {\n      token: this.params.token,\n      ...axiosObj.headers\n    };\n    const result = await (0, apiRequest_1.default)(axiosObj, requestObj.cacheTTL);\n    return result;\n  }\n  static async doRequestAnonymous(requestObj, region) {\n    const apiURI = (0, regions_1.default)(region)?.api;\n    if (!apiURI) {\n      throw new Error(\"Invalid region\");\n    }\n    const axiosObj = mountAxiosRequest(apiURI, requestObj);\n    const result = await (0, apiRequest_1.default)(axiosObj, requestObj.cacheTTL);\n    return result;\n  }\n}\nexports.default = TagoIOModule;","map":{"version":3,"mappings":";;;;;;;;;;AACA;AACA;AACA;AA6CA;;;;;;AAMA,SAASA,iBAAiB,CAACC,GAAW,EAAEC,UAA2B;EACjE,MAAMC,QAAQ,GAAuB;IACnCC,GAAG,EAAE,GAAGH,GAAG,GAAGC,UAAU,CAACG,IAAI,EAAE;IAC/BC,MAAM,EAAEJ,UAAU,CAACI,MAAM;IACzBC,IAAI,EAAEL,UAAU,CAACM,IAAI;IACrBC,MAAM,EAAEP,UAAU,CAACO,MAAM;IACzBC,gBAAgB,EAAER,UAAU,CAACQ,gBAAgB;IAC7CC,gBAAgB,EAAGC,CAAC,IAAKC,YAAE,CAACC,SAAS,CAACF,CAAC,CAAC;IACxCG,OAAO,EAAE;MACP,GAAGb,UAAU,CAACa;KACf;IACD,GAAGb,UAAU,CAACc;GACf;EAED,OAAOb,QAAQ;AACjB;AAEA;;;;AAIA,MAAec,YAAY;EAGzBC,YAAYT,MAAS;IAFX,WAAM,GAAG,EAAO;IAGxB,IAAI,CAACA,MAAM,GAAGA,MAAM;IAEpB,IAAI,CAACU,cAAc,EAAE;EACvB;EAEQA,cAAc;IACpB,IAAI,CAAC,IAAI,CAACV,MAAM,EAAE;MAChB,MAAM,IAAIW,KAAK,CAAC,gBAAgB,CAAC;;IAGnC,IAAI,CAAC,IAAI,CAACX,MAAM,CAACY,KAAK,EAAE;MACtB,MAAM,IAAID,KAAK,CAAC,eAAe,CAAC;;IAGlC;IACA;IACA;EACF;;EAEU,MAAME,SAAS,CAAKpB,UAA2B;IACvD,MAAMqB,MAAM,GAAG,qBAAO,EAAC,IAAI,CAACd,MAAM,CAACe,MAAM,CAAC,EAAEC,GAAG;IAC/C,IAAI,CAACF,MAAM,EAAE;MACX,MAAM,IAAIH,KAAK,CAAC,gBAAgB,CAAC;;IAGnC,MAAMjB,QAAQ,GAAGH,iBAAiB,CAACuB,MAAM,EAAErB,UAAU,CAAC;IACtDC,QAAQ,CAACY,OAAO,GAAG;MACjBM,KAAK,EAAE,IAAI,CAACZ,MAAM,CAACY,KAAK;MACxB,GAAGlB,QAAQ,CAACY;KACb;IAED,MAAMW,MAAM,GAAG,MAAM,wBAAU,EAACvB,QAAQ,EAAED,UAAU,CAACyB,QAAQ,CAAC;IAE9D,OAAOD,MAAqB;EAC9B;EAEU,aAAaE,kBAAkB,CAAK1B,UAA2B,EAAEsB,MAAgB;IACzF,MAAMD,MAAM,GAAG,qBAAO,EAACC,MAAM,CAAC,EAAEC,GAAG;IACnC,IAAI,CAACF,MAAM,EAAE;MACX,MAAM,IAAIH,KAAK,CAAC,gBAAgB,CAAC;;IAGnC,MAAMjB,QAAQ,GAAGH,iBAAiB,CAACuB,MAAM,EAAErB,UAAU,CAAC;IAEtD,MAAMwB,MAAM,GAAG,MAAM,wBAAU,EAACvB,QAAQ,EAAED,UAAU,CAACyB,QAAQ,CAAC;IAE9D,OAAOD,MAAqB;EAC9B;;AAGFG,kBAAeZ,YAAY","names":["mountAxiosRequest","uri","requestObj","axiosObj","url","path","method","data","body","params","maxContentLength","paramsSerializer","p","qs_1","stringify","headers","overwriteAxiosConfig","TagoIOModule","constructor","validateParams","Error","token","doRequest","apiURI","region","api","result","cacheTTL","doRequestAnonymous","exports"],"sources":["C:\\Users\\yudji\\OneDrive\\Documentos\\SGA\\WIDGETS\\mqtt_wid\\dash_mqtt\\node_modules\\@tago-io\\sdk\\src\\common\\TagoIOModule.ts"],"sourcesContent":["import { AxiosRequestConfig, Method } from \"axios\";\nimport qs from \"qs\";\nimport apiRequest from \"../infrastructure/apiRequest\";\nimport regions, { Regions } from \"../regions\";\nimport { RefType, GenericID } from \"./common.types\";\n\ninterface GenericModuleParams {\n  token?: string;\n  region?: Regions;\n  // options?: Object;\n}\n\ninterface ShareModuleParams extends GenericModuleParams {\n  type: RefType;\n}\n\ninterface TokenModuleParams extends GenericModuleParams {\n  path: string;\n  id?: GenericID;\n}\n\ninterface ConnectorModuleParams extends GenericModuleParams {\n  details?: boolean;\n}\n\ninterface AuthorizationModuleParams extends GenericModuleParams {\n  details?: boolean;\n}\n\n/**\n * Object for generate request params\n * @internal\n */\ninterface doRequestParams {\n  path: string;\n  method: Method;\n  body?: any;\n  params?: any;\n  headers?: any;\n  overwriteAxiosConfig?: AxiosRequestConfig;\n  maxContentLength?: number;\n  /**\n   * Cache for request\n   * default: false (disabled)\n   */\n  cacheTTL?: number;\n}\n\n/**\n * Create a Object for Axios\n * @internal\n * @param uri URI\n * @param requestObj doRequestParams\n */\nfunction mountAxiosRequest(uri: string, requestObj: doRequestParams): AxiosRequestConfig {\n  const axiosObj: AxiosRequestConfig = {\n    url: `${uri}${requestObj.path}`,\n    method: requestObj.method,\n    data: requestObj.body,\n    params: requestObj.params,\n    maxContentLength: requestObj.maxContentLength,\n    paramsSerializer: (p) => qs.stringify(p),\n    headers: {\n      ...requestObj.headers,\n    },\n    ...requestObj.overwriteAxiosConfig,\n  };\n\n  return axiosObj;\n}\n\n/**\n * Abstract class to wrap all TagoIO SDK Modules\n * @internal\n */\nabstract class TagoIOModule<T extends GenericModuleParams> {\n  protected params = {} as T;\n\n  constructor(params: T) {\n    this.params = params;\n\n    this.validateParams();\n  }\n\n  private validateParams() {\n    if (!this.params) {\n      throw new Error(\"Invalid Params\");\n    }\n\n    if (!this.params.token) {\n      throw new Error(\"Invalid Token\");\n    }\n\n    // if (this.params.options && typeof this.params.options !== \"object\") {\n    //   throw new Error(\"Invalid Params\");\n    // }\n  }\n\n  protected async doRequest<TR>(requestObj: doRequestParams): Promise<TR> {\n    const apiURI = regions(this.params.region)?.api;\n    if (!apiURI) {\n      throw new Error(\"Invalid region\");\n    }\n\n    const axiosObj = mountAxiosRequest(apiURI, requestObj);\n    axiosObj.headers = {\n      token: this.params.token,\n      ...axiosObj.headers,\n    };\n\n    const result = await apiRequest(axiosObj, requestObj.cacheTTL);\n\n    return result as Promise<TR>;\n  }\n\n  protected static async doRequestAnonymous<TR>(requestObj: doRequestParams, region?: Regions): Promise<TR> {\n    const apiURI = regions(region)?.api;\n    if (!apiURI) {\n      throw new Error(\"Invalid region\");\n    }\n\n    const axiosObj = mountAxiosRequest(apiURI, requestObj);\n\n    const result = await apiRequest(axiosObj, requestObj.cacheTTL);\n\n    return result as Promise<TR>;\n  }\n}\n\nexport default TagoIOModule;\nexport {\n  GenericModuleParams,\n  ShareModuleParams,\n  doRequestParams,\n  TokenModuleParams,\n  ConnectorModuleParams,\n  AuthorizationModuleParams,\n};\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}
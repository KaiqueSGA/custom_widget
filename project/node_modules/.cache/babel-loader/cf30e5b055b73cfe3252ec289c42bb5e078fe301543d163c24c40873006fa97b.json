{"ast":null,"code":"\"use strict\";\n\nvar _objectSpread = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\nvar _createForOfIteratorHelper = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isOldStructure = exports.convert = void 0;\nvar common_1 = require(\"./common\");\nvar EInputControlFieldType;\n(function (EInputControlFieldType) {\n  EInputControlFieldType[\"Switch\"] = \"switch\";\n  EInputControlFieldType[\"Text\"] = \"text\";\n})(EInputControlFieldType || (EInputControlFieldType = {}));\nfunction convert(oldWidget) {\n  var oldDisplay = oldWidget.display || {};\n  var newStructure = {\n    dashboard: oldWidget.dashboard,\n    display: {\n      header_buttons: oldDisplay.header_buttons || [],\n      help: oldDisplay.help || \"\",\n      sections: [],\n      theme: {\n        color: {\n          background: null,\n          field: null,\n          footer: null\n        }\n      }\n    },\n    id: oldWidget.id,\n    label: oldWidget.label,\n    realtime: null,\n    type: \"control\"\n  };\n  var section = {\n    description: \"\",\n    fields: [],\n    id: (0, common_1.generateWidgetItemId)(),\n    show_border: false,\n    show_caption: false,\n    title: \"\"\n  };\n  var _iterator = _createForOfIteratorHelper((oldDisplay === null || oldDisplay === void 0 ? void 0 : oldDisplay.controls) || []),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var oldField = _step.value;\n      var data = _objectSpread(_objectSpread(_objectSpread({}, oldField !== null && oldField !== void 0 && oldField.bucket ? {\n        bucket: oldField === null || oldField === void 0 ? void 0 : oldField.bucket\n      } : {}), oldField !== null && oldField !== void 0 && oldField.origin ? {\n        origin: oldField === null || oldField === void 0 ? void 0 : oldField.origin\n      } : {}), oldField !== null && oldField !== void 0 && oldField.variable ? {\n        variable: oldField === null || oldField === void 0 ? void 0 : oldField.variable\n      } : {});\n      section.fields.push({\n        data: data,\n        icon: null,\n        id: (0, common_1.generateWidgetItemId)(),\n        label: oldField === null || oldField === void 0 ? void 0 : oldField.name,\n        label_selected: (oldField === null || oldField === void 0 ? void 0 : oldField.label_yes) || \"\",\n        label_type: \"text\",\n        label_unselected: (oldField === null || oldField === void 0 ? void 0 : oldField.label_no) || \"\",\n        send_data: true,\n        show_new_line: (oldField === null || oldField === void 0 ? void 0 : oldField.new_line) !== undefined ? oldField === null || oldField === void 0 ? void 0 : oldField.new_line : true,\n        type: (oldField === null || oldField === void 0 ? void 0 : oldField.type) === \"switch\" ? EInputControlFieldType.Switch : EInputControlFieldType.Text\n      });\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  newStructure.display.sections.push(section);\n  if (Array.isArray(oldWidget.data)) {\n    newStructure.data = oldWidget.data;\n  }\n  return newStructure;\n}\nexports.convert = convert;\nfunction isOldStructure(widget) {\n  var _widget$display, _widget$display2;\n  var isOld = !!((widget === null || widget === void 0 ? void 0 : (_widget$display = widget.display) === null || _widget$display === void 0 ? void 0 : _widget$display.watermark) !== undefined || widget !== null && widget !== void 0 && (_widget$display2 = widget.display) !== null && _widget$display2 !== void 0 && _widget$display2.input_type);\n  return isOld;\n}\nexports.isOldStructure = isOldStructure;","map":{"version":3,"mappings":"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","names":["EInputControlFieldType","convert","oldWidget","oldDisplay","display","newStructure","dashboard","header_buttons","help","sections","theme","color","background","field","footer","id","label","realtime","type","section","description","fields","show_border","show_caption","title","controls","oldField","data","bucket","origin","variable","push","icon","name","label_selected","label_yes","label_type","label_unselected","label_no","send_data","show_new_line","new_line","undefined","Switch","Text","Array","isArray","exports","isOldStructure","widget","isOld","watermark","input_type"],"sources":["C:\\Users\\yudji\\OneDrive\\Documentos\\SGA\\WIDGETS\\mqtt_wid\\dash_mqtt\\node_modules\\@tago-io\\sdk\\src\\modules\\Migration\\inputcontrol.ts"],"sourcesContent":["// ? ==================================== (c) TagoIO ====================================\n// * What is this file?\n//     Migration of old INPUT CONTROL to new INPUT CONTROL\n// ? ====================================================================================\nimport { WidgetInfo } from \"../Account/dashboards.types\";\nimport { generateWidgetItemId } from \"./common\";\n\nenum EInputControlFieldType {\n  \"Switch\" = \"switch\",\n  \"Text\" = \"text\",\n}\n\nexport function convert(oldWidget: any): WidgetInfo {\n  const oldDisplay = oldWidget.display || {};\n\n  const newStructure: any = {\n    dashboard: oldWidget.dashboard,\n    display: {\n      header_buttons: oldDisplay.header_buttons || [],\n      help: oldDisplay.help || \"\",\n      sections: [],\n      theme: {\n        color: {\n          background: null,\n          field: null,\n          footer: null,\n        },\n      },\n    },\n    id: oldWidget.id,\n    label: oldWidget.label,\n    realtime: null,\n    type: \"control\",\n  };\n\n  const section: any = {\n    description: \"\",\n    fields: [],\n    id: generateWidgetItemId(),\n    show_border: false,\n    show_caption: false,\n    title: \"\",\n  };\n\n  for (const oldField of oldDisplay?.controls || []) {\n    const data = {\n      ...(oldField?.bucket ? { bucket: oldField?.bucket } : {}),\n      ...(oldField?.origin ? { origin: oldField?.origin } : {}),\n      ...(oldField?.variable ? { variable: oldField?.variable } : {}),\n    };\n\n    section.fields.push({\n      data,\n      icon: null,\n      id: generateWidgetItemId(),\n      label: oldField?.name,\n      label_selected: oldField?.label_yes || \"\",\n      label_type: \"text\",\n      label_unselected: oldField?.label_no || \"\",\n      send_data: true,\n      show_new_line: oldField?.new_line !== undefined ? oldField?.new_line : true,\n      type: oldField?.type === \"switch\" ? EInputControlFieldType.Switch : EInputControlFieldType.Text,\n    });\n  }\n\n  newStructure.display.sections.push(section);\n  if (Array.isArray(oldWidget.data)) {\n    newStructure.data = oldWidget.data;\n  }\n\n  return newStructure;\n}\n\nexport function isOldStructure(widget: any) {\n  const isOld = !!(widget?.display?.watermark !== undefined || widget?.display?.input_type);\n\n  return isOld;\n}\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}
{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isOldStructure = exports.convert = void 0;\nfunction convertSource(oldDisplay) {\n  var type_image = oldDisplay.type_image;\n  if (type_image === \"static\") {\n    return {\n      static_image: (oldDisplay === null || oldDisplay === void 0 ? void 0 : oldDisplay.static_image) || (oldDisplay === null || oldDisplay === void 0 ? void 0 : oldDisplay.static_media),\n      type: \"static\"\n    };\n  }\n  var oldConditions = (oldDisplay === null || oldDisplay === void 0 ? void 0 : oldDisplay.conditions) || [];\n  return {\n    conditions: oldConditions.map(function (e) {\n      return {\n        condition: e === null || e === void 0 ? void 0 : e.condition,\n        url: (e === null || e === void 0 ? void 0 : e.image) || (e === null || e === void 0 ? void 0 : e.media_url),\n        value: e === null || e === void 0 ? void 0 : e.value\n      };\n    }),\n    type: \"conditional\"\n  };\n}\n/**\r\n * Takes the OLD widget and returns the NEW structure.\r\n */\nfunction convert(oldWidget) {\n  var oldDisplay = oldWidget.display || {};\n  var newStructure = {\n    dashboard: oldWidget.dashboard,\n    display: {\n      allow_zoom: false,\n      formula: {\n        enable: false,\n        formula_type: \"fixed\",\n        unit_type: \"origin\",\n        value: \"\"\n      },\n      header_buttons: oldDisplay.header_buttons || [],\n      help: oldDisplay.help || \"\",\n      object_fit: \"contain\",\n      occupy_whole_widget: false,\n      show_zoom_buttons: false,\n      source: convertSource(oldDisplay),\n      theme: {\n        color: {\n          background: null,\n          header: null\n        }\n      }\n    },\n    id: oldWidget.id,\n    label: oldWidget.label,\n    realtime: null,\n    type: \"image\"\n  };\n  if (Array.isArray(oldWidget.data)) {\n    newStructure.data = oldWidget.data;\n  }\n  return newStructure;\n}\nexports.convert = convert;\nfunction isOldStructure(widget) {\n  var _widget$display, _widget$display2, _widget$display3, _widget$display4, _widget$display5;\n  var isOld = !!(widget !== null && widget !== void 0 && (_widget$display = widget.display) !== null && _widget$display !== void 0 && _widget$display.type_media || widget !== null && widget !== void 0 && (_widget$display2 = widget.display) !== null && _widget$display2 !== void 0 && _widget$display2.type_image || widget !== null && widget !== void 0 && (_widget$display3 = widget.display) !== null && _widget$display3 !== void 0 && _widget$display3.static_media || widget !== null && widget !== void 0 && (_widget$display4 = widget.display) !== null && _widget$display4 !== void 0 && _widget$display4.static_image || widget !== null && widget !== void 0 && (_widget$display5 = widget.display) !== null && _widget$display5 !== void 0 && _widget$display5.conditions);\n  return isOld;\n}\nexports.isOldStructure = isOldStructure;","map":{"version":3,"mappings":";;;;;;AAMA,SAASA,aAAa,CAACC,UAAe;EACpC,IAAQC,UAAU,GAAKD,UAAU,CAAzBC,UAAU;EAClB,IAAIA,UAAU,KAAK,QAAQ,EAAE;IAC3B,OAAO;MACLC,YAAY,EAAE,WAAU,aAAVF,UAAU,uBAAVA,UAAU,CAAEE,YAAY,MAAIF,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAEG,YAAY;MAClEC,IAAI,EAAE;KACP;;EAEH,IAAMC,aAAa,GAAG,WAAU,aAAVL,UAAU,uBAAVA,UAAU,CAAEM,UAAU,KAAI,EAAE;EAClD,OAAO;IACLA,UAAU,EAAED,aAAa,CAACE,GAAG,CAAC,UAACC,CAAM;MAAA,OAAM;QACzCC,SAAS,EAAED,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEC,SAAS;QACvBC,GAAG,EAAE,EAAC,aAADF,CAAC,uBAADA,CAAC,CAAEG,KAAK,MAAIH,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEI,SAAS;QAC7BC,KAAK,EAAEL,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEK;OACX;IAAA,CAAC,CAAC;IACHT,IAAI,EAAE;GACP;AACH;AACA;;;AAGA,SAAgBU,OAAO,CAACC,SAAc;EACpC,IAAMf,UAAU,GAAGe,SAAS,CAACC,OAAO,IAAI,EAAE;EAE1C,IAAMC,YAAY,GAAQ;IACxBC,SAAS,EAAEH,SAAS,CAACG,SAAS;IAC9BF,OAAO,EAAE;MACPG,UAAU,EAAE,KAAK;MACjBC,OAAO,EAAE;QACPC,MAAM,EAAE,KAAK;QACbC,YAAY,EAAE,OAAO;QACrBC,SAAS,EAAE,QAAQ;QACnBV,KAAK,EAAE;OACR;MACDW,cAAc,EAAExB,UAAU,CAACwB,cAAc,IAAI,EAAE;MAC/CC,IAAI,EAAEzB,UAAU,CAACyB,IAAI,IAAI,EAAE;MAC3BC,UAAU,EAAE,SAAS;MACrBC,mBAAmB,EAAE,KAAK;MAC1BC,iBAAiB,EAAE,KAAK;MACxBC,MAAM,EAAE9B,aAAa,CAACC,UAAU,CAAC;MACjC8B,KAAK,EAAE;QACLC,KAAK,EAAE;UACLC,UAAU,EAAE,IAAI;UAChBC,MAAM,EAAE;;;KAGb;IACDC,EAAE,EAAEnB,SAAS,CAACmB,EAAE;IAChBC,KAAK,EAAEpB,SAAS,CAACoB,KAAK;IACtBC,QAAQ,EAAE,IAAI;IACdhC,IAAI,EAAE;GACP;EAED,IAAIiC,KAAK,CAACC,OAAO,CAACvB,SAAS,CAACwB,IAAI,CAAC,EAAE;IACjCtB,YAAY,CAACsB,IAAI,GAAGxB,SAAS,CAACwB,IAAI;;EAGpC,OAAOtB,YAAY;AACrB;AArCAuB;AAuCA,SAAgBC,cAAc,CAACC,MAAW;EAAA;EACxC,IAAMC,KAAK,GAAG,CAAC,EACbD,MAAM,aAANA,MAAM,kCAANA,MAAM,CAAE1B,OAAO,4CAAf,gBAAiB4B,UAAU,IAC3BF,MAAM,aAANA,MAAM,mCAANA,MAAM,CAAE1B,OAAO,6CAAf,iBAAiBf,UAAU,IAC3ByC,MAAM,aAANA,MAAM,mCAANA,MAAM,CAAE1B,OAAO,6CAAf,iBAAiBb,YAAY,IAC7BuC,MAAM,aAANA,MAAM,mCAANA,MAAM,CAAE1B,OAAO,6CAAf,iBAAiBd,YAAY,IAC7BwC,MAAM,aAANA,MAAM,mCAANA,MAAM,CAAE1B,OAAO,6CAAf,iBAAiBV,UAAU,CAC5B;EAED,OAAOqC,KAAK;AACd;AAVAH","names":["convertSource","oldDisplay","type_image","static_image","static_media","type","oldConditions","conditions","map","e","condition","url","image","media_url","value","convert","oldWidget","display","newStructure","dashboard","allow_zoom","formula","enable","formula_type","unit_type","header_buttons","help","object_fit","occupy_whole_widget","show_zoom_buttons","source","theme","color","background","header","id","label","realtime","Array","isArray","data","exports","isOldStructure","widget","isOld","type_media"],"sources":["C:\\Users\\kaique\\Documents\\SGA\\widget\\project\\node_modules\\@tago-io\\sdk\\src\\modules\\Migration\\image.ts"],"sourcesContent":["// ? ==================================== (c) TagoIO ====================================\r\n// * What is this file?\r\n//     Migration of old IMAGE to new IMAGE\r\n// ? ====================================================================================\r\nimport { WidgetInfo } from \"../Account/dashboards.types\";\r\n\r\nfunction convertSource(oldDisplay: any) {\r\n  const { type_image } = oldDisplay;\r\n  if (type_image === \"static\") {\r\n    return {\r\n      static_image: oldDisplay?.static_image || oldDisplay?.static_media,\r\n      type: \"static\",\r\n    };\r\n  }\r\n  const oldConditions = oldDisplay?.conditions || [];\r\n  return {\r\n    conditions: oldConditions.map((e: any) => ({\r\n      condition: e?.condition,\r\n      url: e?.image || e?.media_url,\r\n      value: e?.value,\r\n    })),\r\n    type: \"conditional\",\r\n  };\r\n}\r\n/**\r\n * Takes the OLD widget and returns the NEW structure.\r\n */\r\nexport function convert(oldWidget: any): WidgetInfo {\r\n  const oldDisplay = oldWidget.display || {};\r\n\r\n  const newStructure: any = {\r\n    dashboard: oldWidget.dashboard,\r\n    display: {\r\n      allow_zoom: false,\r\n      formula: {\r\n        enable: false,\r\n        formula_type: \"fixed\",\r\n        unit_type: \"origin\",\r\n        value: \"\",\r\n      },\r\n      header_buttons: oldDisplay.header_buttons || [],\r\n      help: oldDisplay.help || \"\",\r\n      object_fit: \"contain\",\r\n      occupy_whole_widget: false,\r\n      show_zoom_buttons: false,\r\n      source: convertSource(oldDisplay),\r\n      theme: {\r\n        color: {\r\n          background: null,\r\n          header: null,\r\n        },\r\n      },\r\n    },\r\n    id: oldWidget.id,\r\n    label: oldWidget.label,\r\n    realtime: null,\r\n    type: \"image\",\r\n  };\r\n\r\n  if (Array.isArray(oldWidget.data)) {\r\n    newStructure.data = oldWidget.data;\r\n  }\r\n\r\n  return newStructure;\r\n}\r\n\r\nexport function isOldStructure(widget: any) {\r\n  const isOld = !!(\r\n    widget?.display?.type_media ||\r\n    widget?.display?.type_image ||\r\n    widget?.display?.static_media ||\r\n    widget?.display?.static_image ||\r\n    widget?.display?.conditions\r\n  );\r\n\r\n  return isOld;\r\n}\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}
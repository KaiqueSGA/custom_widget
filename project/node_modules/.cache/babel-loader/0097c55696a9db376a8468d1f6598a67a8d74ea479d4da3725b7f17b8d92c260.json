{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _classCallCheck = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _inherits = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"C:/Users/yudji/OneDrive/Documentos/SGA/WIDGETS/mqtt_wid/dash_mqtt/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar TagoIOModule_1 = __importDefault(require(\"../../common/TagoIOModule\"));\nvar dateParser_1 = __importDefault(require(\"../Utils/dateParser\"));\nvar ServiceAuthorization = /*#__PURE__*/function (_TagoIOModule_1$defau) {\n  _inherits(ServiceAuthorization, _TagoIOModule_1$defau);\n  var _super = _createSuper(ServiceAuthorization);\n  function ServiceAuthorization() {\n    _classCallCheck(this, ServiceAuthorization);\n    return _super.apply(this, arguments);\n  }\n  _createClass(ServiceAuthorization, [{\n    key: \"tokenList\",\n    value:\n    /**\n     * Retrieves a list of all tokens\n     * @example\n     * Default Query: {\n     *   page: 1,\n     *   fields: [\"name\", \"token\", \"permission\"],\n     *   filter: {},\n     *   amount: 20,\n     *   orderBy: \"created_at,desc\",\n     * }\n     * @param query Search query params\n     */\n    function () {\n      var _tokenList = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(query) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.doRequest({\n                  path: \"/serviceauth\",\n                  method: \"GET\",\n                  params: {\n                    page: (query === null || query === void 0 ? void 0 : query.page) || 1,\n                    fields: (query === null || query === void 0 ? void 0 : query.fields) || [\"name\", \"token\", \"permission\"],\n                    filter: (query === null || query === void 0 ? void 0 : query.filter) || {},\n                    amount: (query === null || query === void 0 ? void 0 : query.amount) || 20,\n                    orderBy: query !== null && query !== void 0 && query.orderBy ? \"\".concat(query.orderBy[0], \",\").concat(query.orderBy[1]) : \"created_at,desc\"\n                  }\n                });\n              case 2:\n                result = _context.sent;\n                result = result.map(function (data) {\n                  return (0, dateParser_1.default)(data, [\"created_at\", \"last_authorization\", \"expire_time\"]);\n                });\n                return _context.abrupt(\"return\", result);\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function tokenList(_x) {\n        return _tokenList.apply(this, arguments);\n      }\n      return tokenList;\n    }()\n    /**\n     * Generates and retrieves a new token\n     * @param tokenParams Token params to create new token\n     */\n  }, {\n    key: \"tokenCreate\",\n    value: function () {\n      var _tokenCreate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(tokenParams) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.doRequest({\n                  path: \"/serviceauth\",\n                  method: \"POST\",\n                  body: tokenParams\n                });\n              case 2:\n                result = _context2.sent;\n                result = (0, dateParser_1.default)(result, [\"expire_date\"]);\n                return _context2.abrupt(\"return\", result);\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n      function tokenCreate(_x2) {\n        return _tokenCreate.apply(this, arguments);\n      }\n      return tokenCreate;\n    }()\n    /**\n     * Deletes a token\n     * @param token Token\n     */\n  }, {\n    key: \"tokenDelete\",\n    value: function () {\n      var _tokenDelete = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(token) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.doRequest({\n                  path: \"/serviceauth/\".concat(token),\n                  method: \"DELETE\"\n                });\n              case 2:\n                result = _context3.sent;\n                return _context3.abrupt(\"return\", result);\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function tokenDelete(_x3) {\n        return _tokenDelete.apply(this, arguments);\n      }\n      return tokenDelete;\n    }()\n  }, {\n    key: \"tokenEdit\",\n    value: function () {\n      var _tokenEdit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(token, verificationCode) {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.doRequest({\n                  path: \"/serviceauth/\".concat(token),\n                  method: \"PUT\",\n                  body: {\n                    verification_code: verificationCode\n                  }\n                });\n              case 2:\n                result = _context4.sent;\n                return _context4.abrupt(\"return\", result);\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function tokenEdit(_x4, _x5) {\n        return _tokenEdit.apply(this, arguments);\n      }\n      return tokenEdit;\n    }()\n  }]);\n  return ServiceAuthorization;\n}(TagoIOModule_1.default);\nexports.default = ServiceAuthorization;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;AACA;AACA;AAA6C,IAEvCA,oBAAqB;EAAA;EAAA;EAAA;IAAA;IAAA;EAAA;EAAA;IAAA;IAAA;IACzB;;;;;;;;;;;;IAAA;MAAA,4EAYO,iBAAgBC,KAAsB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACxB,IAAI,CAACC,SAAS,CAA2B;kBAC1DC,IAAI,gBAAgB;kBACpBC,MAAM,EAAE,KAAK;kBACbC,MAAM,EAAE;oBACNC,IAAI,EAAE,MAAK,aAALL,KAAK,uBAALA,KAAK,CAAEK,IAAI,KAAI,CAAC;oBACtBC,MAAM,EAAE,MAAK,aAALN,KAAK,uBAALA,KAAK,CAAEM,MAAM,KAAI,CAAC,MAAM,EAAE,OAAO,EAAE,YAAY,CAAC;oBACxDC,MAAM,EAAE,MAAK,aAALP,KAAK,uBAALA,KAAK,CAAEO,MAAM,KAAI,EAAE;oBAC3BC,MAAM,EAAE,MAAK,aAALR,KAAK,uBAALA,KAAK,CAAEQ,MAAM,KAAI,EAAE;oBAC3BC,OAAO,EAAET,KAAK,aAALA,KAAK,eAALA,KAAK,CAAES,OAAO,aAAMT,KAAK,CAACS,OAAO,CAAC,CAAC,CAAC,cAAIT,KAAK,CAACS,OAAO,CAAC,CAAC,CAAC,IAAK;;iBAEzE,CAAC;cAAA;gBAVEC,MAAM;gBAYVA,MAAM,GAAGA,MAAM,CAACC,GAAG,CAAC,UAACC,IAAI;kBAAA,OAAK,wBAAU,EAACA,IAAI,EAAE,CAAC,YAAY,EAAE,oBAAoB,EAAE,aAAa,CAAC,CAAC;gBAAA,EAAC;gBAAC,iCAE9FF,MAAM;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACd;MAAA;QAAA;MAAA;MAAA;IAAA;IAED;;;;EAAA;IAAA;IAAA;MAAA,8EAIO,kBAAkBG,WAAsB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OAC1B,IAAI,CAACZ,SAAS,CAAsB;kBACrDC,IAAI,gBAAgB;kBACpBC,MAAM,EAAE,MAAM;kBACdW,IAAI,EAAED;iBACP,CAAC;cAAA;gBAJEH,MAAM;gBAMVA,MAAM,GAAG,wBAAU,EAACA,MAAM,EAAE,CAAC,aAAa,CAAC,CAAC;gBAAC,kCAEtCA,MAAM;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACd;MAAA;QAAA;MAAA;MAAA;IAAA;IAED;;;;EAAA;IAAA;IAAA;MAAA,8EAIO,kBAAkBK,KAAmB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACrB,IAAI,CAACd,SAAS,CAAS;kBAC1CC,IAAI,yBAAkBa,KAAK,CAAE;kBAC7BZ,MAAM,EAAE;iBACT,CAAC;cAAA;gBAHIO,MAAM;gBAAA,kCAKLA,MAAM;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACd;MAAA;QAAA;MAAA;MAAA;IAAA;EAAA;IAAA;IAAA;MAAA,4EAEM,kBAAgBK,KAAmB,EAAEC,gBAAyB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OAC9C,IAAI,CAACf,SAAS,CAAS;kBAC1CC,IAAI,yBAAkBa,KAAK,CAAE;kBAC7BZ,MAAM,EAAE,KAAK;kBACbW,IAAI,EAAE;oBACJG,iBAAiB,EAAED;;iBAEtB,CAAC;cAAA;gBANIN,MAAM;gBAAA,kCAQLA,MAAM;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACd;MAAA;QAAA;MAAA;MAAA;IAAA;EAAA;EAAA;AAAA,EAtEgCQ,sBAAiC;AAyEpEC,kBAAepB,oBAAoB","names":["ServiceAuthorization","query","doRequest","path","method","params","page","fields","filter","amount","orderBy","result","map","data","tokenParams","body","token","verificationCode","verification_code","TagoIOModule_1","exports"],"sources":["C:\\Users\\yudji\\OneDrive\\Documentos\\SGA\\WIDGETS\\mqtt_wid\\dash_mqtt\\node_modules\\@tago-io\\sdk\\src\\modules\\Account\\ServiceAuthorization.ts"],"sourcesContent":["import { GenericToken, ListTokenQuery, TokenCreateResponse, TokenData, TokenDataList } from \"../../common/common.types\";\nimport TagoIOModule, { GenericModuleParams } from \"../../common/TagoIOModule\";\nimport dateParser from \"../Utils/dateParser\";\n\nclass ServiceAuthorization extends TagoIOModule<GenericModuleParams> {\n  /**\n   * Retrieves a list of all tokens\n   * @example\n   * Default Query: {\n   *   page: 1,\n   *   fields: [\"name\", \"token\", \"permission\"],\n   *   filter: {},\n   *   amount: 20,\n   *   orderBy: \"created_at,desc\",\n   * }\n   * @param query Search query params\n   */\n  public async tokenList(query?: ListTokenQuery): Promise<Partial<TokenDataList>[]> {\n    let result = await this.doRequest<Partial<TokenDataList>[]>({\n      path: `/serviceauth`,\n      method: \"GET\",\n      params: {\n        page: query?.page || 1,\n        fields: query?.fields || [\"name\", \"token\", \"permission\"],\n        filter: query?.filter || {},\n        amount: query?.amount || 20,\n        orderBy: query?.orderBy ? `${query.orderBy[0]},${query.orderBy[1]}` : \"created_at,desc\",\n      },\n    });\n\n    result = result.map((data) => dateParser(data, [\"created_at\", \"last_authorization\", \"expire_time\"]));\n\n    return result;\n  }\n\n  /**\n   * Generates and retrieves a new token\n   * @param tokenParams Token params to create new token\n   */\n  public async tokenCreate(tokenParams: TokenData): Promise<TokenCreateResponse> {\n    let result = await this.doRequest<TokenCreateResponse>({\n      path: `/serviceauth`,\n      method: \"POST\",\n      body: tokenParams,\n    });\n\n    result = dateParser(result, [\"expire_date\"]);\n\n    return result;\n  }\n\n  /**\n   * Deletes a token\n   * @param token Token\n   */\n  public async tokenDelete(token: GenericToken): Promise<string> {\n    const result = await this.doRequest<string>({\n      path: `/serviceauth/${token}`,\n      method: \"DELETE\",\n    });\n\n    return result;\n  }\n\n  public async tokenEdit(token: GenericToken, verificationCode?: string): Promise<string> {\n    const result = await this.doRequest<string>({\n      path: `/serviceauth/${token}`,\n      method: \"PUT\",\n      body: {\n        verification_code: verificationCode,\n      },\n    });\n\n    return result;\n  }\n}\n\nexport default ServiceAuthorization;\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}
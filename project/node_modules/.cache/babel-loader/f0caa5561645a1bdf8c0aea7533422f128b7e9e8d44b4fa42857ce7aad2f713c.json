{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isOldStructure = exports.convert = void 0;\nfunction convert(oldWidget) {\n  const oldDisplay = oldWidget.display || {};\n  let decimalsString = \"\";\n  if (oldDisplay?.numberformat && typeof oldDisplay?.numberformat === \"string\") {\n    decimalsString = oldDisplay?.numberformat?.split(\".\")?.[1] || \"\";\n  }\n  const decimals = decimalsString.length || -1;\n  const newStructure = {\n    dashboard: oldWidget.dashboard,\n    display: {\n      alias: oldDisplay?.gauge_label || \"\",\n      formula: {\n        fixed_unit: oldDisplay?.unit,\n        unit_type: oldDisplay?.unit ? \"fixed\" : \"origin\"\n      },\n      header_buttons: oldDisplay.header_buttons || [],\n      help: oldDisplay.help || \"\",\n      number_format: {\n        decimals,\n        show_thousand: false\n      },\n      range: {\n        maximum: oldDisplay?.maximum || 100,\n        minimum: oldDisplay?.minimum || 0,\n        type: \"minmax\"\n      },\n      show_variables: !oldDisplay?.hide_variables,\n      theme: {\n        color: {\n          background: null,\n          fill: null,\n          header: null,\n          text: null,\n          text_background: null\n        }\n      }\n    },\n    id: oldWidget.id,\n    label: oldWidget.label,\n    realtime: null,\n    type: \"grainbin\"\n  };\n  if (Array.isArray(oldWidget.data)) {\n    newStructure.data = [oldWidget.data?.[0]] || [];\n  }\n  return newStructure;\n}\nexports.convert = convert;\nfunction isOldStructure(widget) {\n  const isOld = !!(widget?.display?.gauge_label || widget?.display?.minimum || widget?.display?.maximum || widget?.display?.unit);\n  return isOld;\n}\nexports.isOldStructure = isOldStructure;","map":{"version":3,"mappings":";;;;;;AAMA,SAAgBA,OAAO,CAACC,SAAc;EACpC,MAAMC,UAAU,GAAGD,SAAS,CAACE,OAAO,IAAI,EAAE;EAE1C,IAAIC,cAAc,GAAG,EAAE;EACvB,IAAIF,UAAU,EAAEG,YAAY,IAAI,OAAOH,UAAU,EAAEG,YAAY,KAAK,QAAQ,EAAE;IAC5ED,cAAc,GAAGF,UAAU,EAAEG,YAAY,EAAEC,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE;;EAElE,MAAMC,QAAQ,GAAGH,cAAc,CAACI,MAAM,IAAI,CAAC,CAAC;EAE5C,MAAMC,YAAY,GAAQ;IACxBC,SAAS,EAAET,SAAS,CAACS,SAAS;IAC9BP,OAAO,EAAE;MACPQ,KAAK,EAAET,UAAU,EAAEU,WAAW,IAAI,EAAE;MACpCC,OAAO,EAAE;QACPC,UAAU,EAAEZ,UAAU,EAAEa,IAAI;QAC5BC,SAAS,EAAEd,UAAU,EAAEa,IAAI,GAAG,OAAO,GAAG;OACzC;MACDE,cAAc,EAAEf,UAAU,CAACe,cAAc,IAAI,EAAE;MAC/CC,IAAI,EAAEhB,UAAU,CAACgB,IAAI,IAAI,EAAE;MAC3BC,aAAa,EAAE;QACbZ,QAAQ;QACRa,aAAa,EAAE;OAChB;MACDC,KAAK,EAAE;QACLC,OAAO,EAAEpB,UAAU,EAAEoB,OAAO,IAAI,GAAG;QACnCC,OAAO,EAAErB,UAAU,EAAEqB,OAAO,IAAI,CAAC;QACjCC,IAAI,EAAE;OACP;MACDC,cAAc,EAAE,CAACvB,UAAU,EAAEwB,cAAc;MAC3CC,KAAK,EAAE;QACLC,KAAK,EAAE;UACLC,UAAU,EAAE,IAAI;UAChBC,IAAI,EAAE,IAAI;UACVC,MAAM,EAAE,IAAI;UACZC,IAAI,EAAE,IAAI;UACVC,eAAe,EAAE;;;KAGtB;IACDC,EAAE,EAAEjC,SAAS,CAACiC,EAAE;IAChBC,KAAK,EAAElC,SAAS,CAACkC,KAAK;IACtBC,QAAQ,EAAE,IAAI;IACdZ,IAAI,EAAE;GACP;EAED,IAAIa,KAAK,CAACC,OAAO,CAACrC,SAAS,CAACsC,IAAI,CAAC,EAAE;IACjC9B,YAAY,CAAC8B,IAAI,GAAG,CAACtC,SAAS,CAACsC,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE;;EAEjD,OAAO9B,YAAY;AACrB;AAjDA+B;AAmDA,SAAgBC,cAAc,CAACC,MAAW;EACxC,MAAMC,KAAK,GAAG,CAAC,EACbD,MAAM,EAAEvC,OAAO,EAAES,WAAW,IAC5B8B,MAAM,EAAEvC,OAAO,EAAEoB,OAAO,IACxBmB,MAAM,EAAEvC,OAAO,EAAEmB,OAAO,IACxBoB,MAAM,EAAEvC,OAAO,EAAEY,IAAI,CACtB;EAED,OAAO4B,KAAK;AACd;AATAH","names":["convert","oldWidget","oldDisplay","display","decimalsString","numberformat","split","decimals","length","newStructure","dashboard","alias","gauge_label","formula","fixed_unit","unit","unit_type","header_buttons","help","number_format","show_thousand","range","maximum","minimum","type","show_variables","hide_variables","theme","color","background","fill","header","text","text_background","id","label","realtime","Array","isArray","data","exports","isOldStructure","widget","isOld"],"sources":["C:\\Users\\kaique\\Documents\\SGA\\widget\\project\\node_modules\\@tago-io\\sdk\\src\\modules\\Migration\\grainbin.ts"],"sourcesContent":["// ? ==================================== (c) TagoIO ====================================\r\n// * What is this file?\r\n//     Migration of old GRAINBIN to new GRAINBIN\r\n// ? ====================================================================================\r\nimport { WidgetInfo } from \"../Account/dashboards.types\";\r\n\r\nexport function convert(oldWidget: any): WidgetInfo {\r\n  const oldDisplay = oldWidget.display || {};\r\n\r\n  let decimalsString = \"\";\r\n  if (oldDisplay?.numberformat && typeof oldDisplay?.numberformat === \"string\") {\r\n    decimalsString = oldDisplay?.numberformat?.split(\".\")?.[1] || \"\";\r\n  }\r\n  const decimals = decimalsString.length || -1;\r\n\r\n  const newStructure: any = {\r\n    dashboard: oldWidget.dashboard,\r\n    display: {\r\n      alias: oldDisplay?.gauge_label || \"\",\r\n      formula: {\r\n        fixed_unit: oldDisplay?.unit,\r\n        unit_type: oldDisplay?.unit ? \"fixed\" : \"origin\",\r\n      },\r\n      header_buttons: oldDisplay.header_buttons || [],\r\n      help: oldDisplay.help || \"\",\r\n      number_format: {\r\n        decimals,\r\n        show_thousand: false,\r\n      },\r\n      range: {\r\n        maximum: oldDisplay?.maximum || 100,\r\n        minimum: oldDisplay?.minimum || 0,\r\n        type: \"minmax\",\r\n      },\r\n      show_variables: !oldDisplay?.hide_variables,\r\n      theme: {\r\n        color: {\r\n          background: null,\r\n          fill: null,\r\n          header: null,\r\n          text: null,\r\n          text_background: null,\r\n        },\r\n      },\r\n    },\r\n    id: oldWidget.id,\r\n    label: oldWidget.label,\r\n    realtime: null,\r\n    type: \"grainbin\",\r\n  };\r\n\r\n  if (Array.isArray(oldWidget.data)) {\r\n    newStructure.data = [oldWidget.data?.[0]] || [];\r\n  }\r\n  return newStructure;\r\n}\r\n\r\nexport function isOldStructure(widget: any) {\r\n  const isOld = !!(\r\n    widget?.display?.gauge_label ||\r\n    widget?.display?.minimum ||\r\n    widget?.display?.maximum ||\r\n    widget?.display?.unit\r\n  );\r\n\r\n  return isOld;\r\n}\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}